### Subjective and Objective Cognitive Change Patterns in Depression

Reproducible code for the manuscript:

"Subjective and objective cognitive impairments differentially predict symptom recovery in major depressive disorder: a cross-lagged panel network analyses" (manuscript submitted)

This repository contains the full data-processing and analysis pipeline used to generate all figures and tables reported in the main text and supplementary materials. The workflow is organized into three stages:

- 01_preprocessing: multiple imputation and inverse probability weighting (IPW)
- 02_main_analysis: cross-sectional and cross-lagged panel network analyses
- 03_rubin_pooling: Rubin’s rules pooling for multiply imputed analyses

The code is written in R. Please ensure you have a recent version of R installed and the packages referenced at the top of each script. 

## Folder overview

- 01_preprocessing/
  - preprocessing.R
    - Performs multiple imputation, computes inverse probability weights, and prepares two sets of outputs:
      1) The MI-averaged dataset used for the main analyses.
      2) A list of 10 imputed datasets used for Rubin’s pooling.

- 02_main_analysis/
  - cross_sectional_analysis.R
    - Runs cross-sectional network analyses. All visual network plots and bridge (centrality) plots used in the paper are produced here. Figures 1–3 in the main text are generated by this script. The NCT result tables for the supplement also originate here.
  - cross_lagged_analysis.r
    - Runs cross-lagged panel network analyses. Figure 4 in the main text is generated by this script. Visualizations of the cross-lagged networks are produced here as well.

- 03_rubin_pooling/
  - cross_sectional_rubin/
    - network_analysis.r (helper called by runner scripts; no edits needed)
    - step1_run_analysis.r (runner)
    - step2_rubin.r (Rubin’s pooling)
    - Implements cross-sectional analyses across the 10 imputed datasets, then pools estimates using Rubin’s rules to provide pooled means, SEs, and confidence intervals.
  - cross_lagged_rubin/
    - cross_lagged_analysis.r (helper called by runner scripts; no edits needed)
    - step1_run_cross_lagged.r (runner)
    - step2_rubin_cross_lagged.r (Rubin’s pooling)
    - Implements cross-lagged panel analyses across the 10 imputed datasets, then pools estimates using Rubin’s rules to provide pooled means, SEs, and confidence intervals.

## What each stage produces

- 01_preprocessing
  - MI-averaged dataset for main analyses.
  - Ten imputed datasets for pooled inference via Rubin’s rules.
  - Inverse probability weights used downstream.

- 02_main_analysis
  - Cross-sectional networks, bridge metrics, and NCT comparison tables.
  - Cross-lagged panel network results.
  - Main-text visuals: Figures 1–3 (cross-sectional) and Figure 4 (cross-lagged).

- 03_rubin_pooling
  - Pooled parameter estimates, standard errors, and confidence intervals for both cross-sectional and cross-lagged models based on the 10 imputed datasets.
  - Tables of pooled network statistics used in the main text and supplement.

## How to run

Before running, configure your data and output locations:

- Set your working directory to any location you prefer. The repository does not include data.
- In each script you intend to run, specify where to read input data and where to write outputs. Adjust any path variables inside the scripts to point to your environment (e.g., data directories, results folders).

1) Preprocessing (multiple imputation + IPW)

```r
# Configure input/output paths inside the script, then run from any working directory
source("/path/to/repo/01_preprocessing/preprocessing.R")
```

1) Main analyses (figures and visualizations)

- Cross-sectional networks:

```r
# Configure input/output paths inside the script, then run from any working directory
source("/path/to/repo/02_main_analysis/cross_sectional_analysis.R")
```

- Cross-lagged panel networks:

```r
# Configure input/output paths inside the script, then run from any working directory
source("/path/to/repo/02_main_analysis/cross_lagged_analysis.r")
```

3) Rubin’s pooling (tables of pooled estimates, SE, CI)

- Cross-sectional pooling:

```r
# Configure input/output paths inside the scripts, then run from any working directory
source("/path/to/repo/03_rubin_pooling/cross_sectional_rubin/step1_run_analysis.r")
source("/path/to/repo/03_rubin_pooling/cross_sectional_rubin/step2_rubin.r")
```

  - Note: `network_analysis.r` is called by `step1_run_analysis.r`; no changes are required to that file.

- Cross-lagged pooling:

```r
# Configure input/output paths inside the scripts, then run from any working directory
source("/path/to/repo/03_rubin_pooling/cross_lagged_rubin/step1_run_cross_lagged.r")
source("/path/to/repo/03_rubin_pooling/cross_lagged_rubin/step2_rubin_cross_lagged.r")
```

  - Note: `cross_lagged_analysis.r` is called by `step1_run_cross_lagged.r`; no changes are required to that file.

## Parallelization

All Rubin pooling runner scripts currently execute analyses sequentially. If runtime is a concern, you may parallelize where appropriate (e.g., across the 10 imputations) using your preferred parallel framework in R. Ensure that random seeds are set for reproducibility when parallelizing.

## Reproducibility notes

- Set a fixed random seed where indicated in scripts to ensure identical results across runs.
- Install the packages listed at the top of each script before running.
- Paths can be adjusted as needed; by default, scripts assume execution from the repository root (or the specified subfolder in the pooling stage).

## Outputs referenced in the manuscript

- Numerical network estimates and confidence intervals used in the main text and supplement are produced in `03_rubin_pooling`.
- All visual network and bridge plots, and the NCT result tables in the supplement, are produced in `02_main_analysis`.

## Citation

If you use this code, please cite the manuscript above. 
